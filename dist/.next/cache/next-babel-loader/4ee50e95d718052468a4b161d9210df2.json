{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n/* eslint-disable no-return-assign */\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\nimport * as React from 'react';\nimport { Form, Input, Button, Space, Select, Row, Col, Upload, Checkbox, Divider } from 'antd';\nimport Router from 'next/router';\nimport { UploadOutlined } from '@ant-design/icons';\nimport { tailFormItemLayout, unitPrices } from 'src/lib';\nimport FormInputItem from '@components/common/base/input-item-list';\nimport NumberFormat from '@components/common/layout/numberformat';\nimport './index.less';\nvar imageStyle = {\n  height: 225,\n  width: 225,\n  objectFit: 'cover',\n  marginTop: 10\n};\nvar defaultValue = {\n  description: '',\n  isSaleVideo: false,\n  isBought: false\n};\nvar Option = Select.Option;\nvar PERFORMER_VIDEO_STATUS = [{\n  key: 'draft',\n  name: 'Draft'\n}, {\n  key: 'active',\n  name: 'Active'\n}, {\n  key: 'inactive',\n  name: 'Inactive'\n}];\nvar leftInputFrom = [{\n  name: 'title',\n  label: 'Title',\n  rules: [{\n    required: true,\n    message: 'Please input video title!'\n  }],\n  children: __jsx(Input, {\n    placeholder: \"Enter Video Title\"\n  })\n}, {\n  name: 'description',\n  label: 'Description',\n  children: __jsx(Input.TextArea, {\n    placeholder: \"Enter Video Description\"\n  })\n}];\n\nvar VideoForm = function VideoForm(_ref) {\n  var _video$video, _video$trailer;\n\n  var onFinish = _ref.onFinish,\n      loading = _ref.loading,\n      video = _ref.video;\n  var inputRef;\n  var selectRef;\n\n  var _Form$useForm = Form.useForm(),\n      _Form$useForm2 = _slicedToArray(_Form$useForm, 1),\n      form = _Form$useForm2[0];\n\n  if (video !== null && video !== void 0 && video.token && !unitPrices.find(function (p) {\n    return p.value === video.token;\n  })) {\n    unitPrices.push({\n      value: video.token,\n      text: __jsx(NumberFormat, {\n        value: video.token,\n        suffix: \" tokens\"\n      })\n    });\n    unitPrices.sort(function (a, b) {\n      return a.value - b.value;\n    });\n  }\n\n  var _React$useState = React.useState(unitPrices),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      tokens = _React$useState2[0],\n      setTokenPrice = _React$useState2[1];\n\n  var _React$useState3 = React.useState(video.isSaleVideo),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      isSaleVideo = _React$useState4[0],\n      setIsSaleVideo = _React$useState4[1];\n\n  var _React$useState5 = React.useState(video.thumbnail || ''),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      thumbnailFile = _React$useState6[0],\n      setThumbnail = _React$useState6[1];\n\n  var priceSelectOptions = tokens.map(function (price) {\n    return {\n      label: price.text,\n      value: price.value\n    };\n  });\n  var rightInputFrom = [{\n    name: 'token',\n    label: 'Token',\n    rules: [{\n      required: true,\n      message: 'Please input video token!'\n    }, {\n      validator: function validator(_, value) {\n        return new Promise(function (resolve, reject) {\n          if (parseInt(value, 10) > 0) return resolve(null);\n          return reject(new Error('Price must be positive integer number!'));\n        });\n      }\n    }],\n    children: __jsx(Select, {\n      ref: function ref(_ref3) {\n        return selectRef = _ref3;\n      },\n      placeholder: \"Please Select Number of Token\",\n      onKeyDown: function onKeyDown(e) {\n        if (e.keyCode === 13) {\n          return e.preventDefault();\n        }\n\n        return {};\n      },\n      options: priceSelectOptions,\n      dropdownRender: function dropdownRender(menu) {\n        return __jsx(React.Fragment, null, menu, __jsx(Divider, {\n          dashed: true\n        }), __jsx(Input, {\n          placeholder: \"Input number of token\",\n          type: \"number\",\n          min: 1,\n          ref: function ref(_ref2) {\n            return inputRef = _ref2;\n          },\n          onPressEnter: function onPressEnter() {\n            var token = parseInt(inputRef.state.value, 10);\n            if (token < 1) token = 1;\n            setTimeout(function () {\n              form.setFieldsValue({\n                token: token\n              });\n            }, 100);\n            if (tokens.find(function (t) {\n              return t.value === token;\n            })) return;\n            setTokenPrice([].concat(_toConsumableArray(tokens), [{\n              text: \"\".concat(token, \" tokens\"),\n              value: token\n            }]).sort(function (a, b) {\n              return a.value - b.value;\n            }));\n          }\n        }));\n      }\n    })\n  }, {\n    name: 'status',\n    label: 'Status',\n    rules: [{\n      required: true,\n      message: 'Please input video status!'\n    }],\n    children: __jsx(Select, {\n      placeholder: \"Select Video Status\"\n    }, PERFORMER_VIDEO_STATUS.map(function (status) {\n      return __jsx(Option, {\n        key: status.key,\n        value: status.key\n      }, status.name);\n    }))\n  }];\n\n  var _React$useState7 = React.useState([]),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      videoFIle = _React$useState8[0],\n      setVideoFile = _React$useState8[1];\n\n  var _React$useState9 = React.useState([]),\n      _React$useState10 = _slicedToArray(_React$useState9, 2),\n      trailerFile = _React$useState10[0],\n      setTrailerFile = _React$useState10[1];\n\n  var onVideoFileChange = function onVideoFileChange(_ref4) {\n    var file = _ref4.file;\n    setVideoFile([_objectSpread(_objectSpread({}, file), {}, {\n      status: 'success',\n      percent: 100\n    })]);\n  };\n\n  var onVideoTrailerChange = function onVideoTrailerChange(_ref5) {\n    var file = _ref5.file;\n    setTrailerFile([_objectSpread(_objectSpread({}, file), {}, {\n      status: 'success',\n      percent: 100\n    })]);\n  };\n\n  var onThumbnailChange = function onThumbnailChange(info) {\n    var reader = new FileReader();\n\n    reader.onload = function (e) {\n      setThumbnail(e.target.result);\n    };\n\n    reader.readAsDataURL(info.fileList[0].originFileObj);\n  };\n\n  return __jsx(Form // {...formItemLayout}\n  , {\n    form: form,\n    onFinish: onFinish,\n    className: \"video-form\",\n    initialValues: _objectSpread(_objectSpread({}, defaultValue), video),\n    layout: \"vertical\"\n  }, __jsx(Row, {\n    gutter: 25\n  }, __jsx(Col, {\n    sm: 12,\n    xs: 24\n  }, __jsx(FormInputItem, {\n    fields: leftInputFrom\n  }), __jsx(Form.Item, {\n    name: \"video\",\n    label: \"Video\",\n    rules: [{\n      required: true,\n      message: 'File is required'\n    }]\n  }, __jsx(Upload, {\n    showUploadList: {\n      showRemoveIcon: false,\n      showPreviewIcon: true,\n      showDownloadIcon: false\n    },\n    listType: \"picture\",\n    fileList: videoFIle,\n    accept: \"video/*\",\n    customRequest: function customRequest() {\n      return true;\n    },\n    onChange: onVideoFileChange\n  }, __jsx(Button, {\n    block: true\n  }, __jsx(UploadOutlined, null), ' ', \"Upload File\"))), (video === null || video === void 0 ? void 0 : (_video$video = video.video) === null || _video$video === void 0 ? void 0 : _video$video.url) && __jsx(Form.Item, null, __jsx(\"video\", {\n    src: video.video.url,\n    style: imageStyle,\n    controls: true\n  })), __jsx(Form.Item, {\n    name: \"trailer\",\n    label: \"Trailer\"\n  }, __jsx(Upload, {\n    showUploadList: {\n      showRemoveIcon: false,\n      showPreviewIcon: true,\n      showDownloadIcon: false\n    },\n    listType: \"picture\",\n    fileList: trailerFile,\n    accept: \"video/*,.mkv\",\n    customRequest: function customRequest() {\n      return true;\n    },\n    onChange: onVideoTrailerChange\n  }, __jsx(Button, {\n    block: true\n  }, __jsx(UploadOutlined, null), ' ', \"Upload File\"))), (video === null || video === void 0 ? void 0 : (_video$trailer = video.trailer) === null || _video$trailer === void 0 ? void 0 : _video$trailer.url) && __jsx(Form.Item, null, __jsx(\"video\", {\n    src: video.trailer.url,\n    style: imageStyle,\n    controls: true\n  })), __jsx(Form.Item, {\n    name: \"thumbnail\",\n    label: \"Thumbnail\"\n  }, __jsx(Upload, {\n    showUploadList: false,\n    accept: \"image/*\",\n    customRequest: function customRequest() {\n      return true;\n    },\n    onChange: onThumbnailChange\n  }, __jsx(Button, {\n    block: true\n  }, __jsx(UploadOutlined, null), ' ', \"Upload File\"), __jsx(\"div\", null, thumbnailFile && __jsx(\"img\", {\n    src: thumbnailFile,\n    style: imageStyle,\n    alt: \"\"\n  }))))), __jsx(Col, {\n    sm: 12,\n    xs: 24\n  }, __jsx(Form.Item, rightInputFrom[1]), __jsx(Form.Item, {\n    name: \"isSaleVideo\",\n    required: true\n  }, __jsx(Checkbox, {\n    checked: isSaleVideo,\n    onChange: function onChange(e) {\n      return [setIsSaleVideo(!isSaleVideo), form.setFieldsValue({\n        isSaleVideo: !isSaleVideo\n      })];\n    }\n  }, \"Is for sale?\")), isSaleVideo && __jsx(Form.Item, rightInputFrom[0]))), __jsx(Form.Item, tailFormItemLayout, __jsx(Space, null, __jsx(Button, {\n    type: \"primary\",\n    htmlType: \"submit\",\n    disabled: loading,\n    loading: loading\n  }, \"Save Changes\"), __jsx(Button, {\n    type: \"primary\",\n    onClick: function onClick() {\n      return Router.back();\n    }\n  }, \"Back\"))));\n};\n\nVideoForm.defaultProps = {\n  video: null\n};\nexport default VideoForm;","map":null,"metadata":{},"sourceType":"module"}